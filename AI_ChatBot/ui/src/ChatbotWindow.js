import React,{ useEffect ,useRef} from 'react';
import { Widget, addResponseMessage } from 'react-chat-widget';
import axios from 'axios';
import 'react-chat-widget/lib/styles.css';
import logo from './logo.svg';


const ChatbotWindow = () => {
  useEffect(() => {
    addResponseMessage('Welcome to this awesome chat!');
  }, []);

  const downloadLinkRef = useRef();



  const handleNewUserMessage = (newMessage) => {
    console.log(`New message incoming! ${newMessage}`);
    // Now send the message throught the backend API
    axios(
        {
          method:"GET",
          url:"/api?user_req=" + newMessage,
          headers:{}
        }
      ).then( res=>{
            console.log(res);
            addResponseMessage(res.data);
      });
    
  };

  return (
    <div className="">
      <div style={{padding:'70px'}}>
        <svg xmlns="http://www.w3.org/2000/svg" width="367.899" height="236.815" viewBox="0 0 367.899 236.815">
        <g id="CMRIT_logo" data-name="CMRIT logo" transform="translate(0.514 0.5)">
        <path id="IOT" d="M233.258,273l-.921-.137V253.18h-2.457c-2.184,0-2.457-.1-2.457-.858,0-.82.273-.858,6.173-.858,5.658,0,6.162.063,6.037.751-.109.6-.642.776-2.685.879l-2.548.128-.11,9.959-.11,9.959Zm9.078-.042c-.094-.1-.171-4.975-.171-10.838V251.463h5.149c4.683,0,5.137.068,5.012.751-.117.64-.7.769-3.921.875l-3.784.123v7.66L248.2,261c3.027.1,3.6.24,3.716.875.122.671-.261.751-3.579.751h-3.716v9.014h3.891c3.432,0,3.891.089,3.891.751s-.509.751-4.949.751a39.266,39.266,0,0,1-5.119-.179Zm17.627-.406c-3.214-2.054-4.416-5.009-4.416-10.856,0-6.735,2.676-10.451,7.5-10.42,3.465.023,5.649,1.615,6.376,4.648.251,1.05.177,1.118-1.21,1.118-1.062,0-1.478-.187-1.478-.665a4.43,4.43,0,0,0-2.426-3.551c-4.374-1.6-7.42,4.2-6.2,11.8.793,4.928,2.633,7.153,5.917,7.153a7.959,7.959,0,0,0,3.1-.715c1.7-.89,1.652-.895,1.652.165,0,1.992-6.3,2.938-8.823,1.325ZM272.882,262.3V251.463h1.01c1.008,0,1.011.014,1.126,4.829l.116,4.829,8.4.245v-9.9h2.457v21.36l-1.014.2a1.978,1.978,0,0,1-1.229-.021,35.792,35.792,0,0,1-.214-5.3v-5.079h-8.6v10.516h-2.048Zm18.429.036V251.463h2.874l4.156,9.014a83.693,83.693,0,0,0,4.5,9.014c.19,0,.346-4.056.346-9.014v-9.014h1.843l-.116,10.731c-.087,8.052-.24,10.739-.614,10.764a12.244,12.244,0,0,0-1.251.182c-.614.122-1.559-1.568-5.119-9.154l-4.367-9.3-.2,9.193c-.2,9.158-.208,9.193-1.126,9.264l-.921.071V262.336Zm22.234,10.174c-3.852-2.461-5.4-10.913-3.033-16.528,2.128-5.041,8.012-6.424,11.486-2.7,1.875,2.01,2.613,5.108,2.417,10.15-.185,4.755-1.182,7.249-3.574,8.938a7.536,7.536,0,0,1-7.295.139Zm6.19-1.754c1.82-1.675,2.461-4.469,2.223-9.685-.215-4.694-1.115-6.91-3.255-8.006a3,3,0,0,0-3.072-.215c-1.266.433-1.781.945-2.519,2.5-1.195,2.521-1.622,7.791-.919,11.331.993,5,4.484,6.884,7.542,4.071Zm9.254-8.455V251.463h2.5l-.128,19.959,3.525.124c3.008.106,3.525.232,3.525.858,0,.651-.538.734-4.71.734h-4.71Zm15.652,10.339c-2.688-1.388-4.185-5.048-4.185-10.231,0-5.68,1.77-9.413,5.1-10.744a6.113,6.113,0,0,1,7.273,1.553c1.732,1.908,2.313,3.641,2.649,7.9.27,3.414-.575,7.69-1.906,9.649C351.908,273.212,347.527,274.13,344.642,272.639Zm6.283-2.074c2.522-2.8,3.007-10.892.911-15.172-1.881-3.839-6.033-3.762-7.9.146-.683,1.431-.819,2.575-.819,6.867,0,5.741.619,7.876,2.614,9.012a3.814,3.814,0,0,0,5.192-.855Zm12.46,1.992c-3.137-1.749-4.815-6.4-4.37-12.1.274-3.513,1.248-6.114,2.8-7.484,3.252-2.868,9.012-2.244,11.011,1.191,1.163,2,1.052,2.876-.364,2.876-.982,0-1.269-.273-1.813-1.726-1.242-3.314-5.08-3.74-7.42-.825-2.061,2.567-2.432,9.822-.71,13.9,1.1,2.608,2.9,3.778,5.466,3.547,2.967-.267,3.188-.634,3.188-5.292v-4.025h-2.419c-2.217,0-2.4-.072-2.2-.859s.559-.858,3.647-.858h3.433v10.772l-1.741.828c-2.337,1.112-6.557,1.137-8.5.051Zm18.845-4.438v-4.8l-3.072-5.726c-1.689-3.149-3.072-5.816-3.072-5.926s.521-.2,1.158-.2c1.045,0,1.393.44,3.561,4.507a28.169,28.169,0,0,0,2.7,4.507,28.014,28.014,0,0,0,2.684-4.5c2.128-4.007,2.513-4.5,3.516-4.507.619,0,1.126.075,1.126.175s-1.474,2.772-3.276,5.937l-3.276,5.755v9.587H382.23ZM257.115,236.947c-.981-.24-1.237-.537-1.27-1.477a3.819,3.819,0,0,1,.051-1.177c.051,0,.876.29,1.833.644,3.434,1.27,6.407.51,7.351-1.88.983-2.488-.049-4.043-4.332-6.52-3.743-2.165-5.067-3.742-5.067-6.033,0-3.761,2.134-5.526,6.683-5.526,3.3,0,3.965.253,3.965,1.5,0,.979,0,.979-2.125.327-2.624-.806-4.626-.374-5.773,1.246-1.583,2.236-.512,3.837,4.634,6.928,3.729,2.24,4.707,3.546,4.67,6.236a5.117,5.117,0,0,1-2.934,5.026,15.452,15.452,0,0,1-7.686.7Zm50.617-.183c-3.107-1.2-3.7-3.4-3.714-13.736l-.01-7.619h2.457v8.477c0,7.645.08,8.612.8,9.849A4.114,4.114,0,0,0,312.7,235.4c2.3-1.146,2.519-2.063,2.694-11.51l.157-8.477h1.974v8.477c0,9.258-.258,10.519-2.5,12.237-1.339,1.028-5.372,1.383-7.294.641Zm53.986.125c-2-.636-3.222-1.825-4.348-4.237-.988-2.116-1.129-2.925-1.137-6.5-.008-3.692.11-4.336,1.22-6.662,1.609-3.372,3.207-4.507,6.348-4.507,2.886,0,4.672,1.128,6.143,3.88.94,1.758,1.024,2.354,1.024,7.28,0,5.124-.052,5.459-1.166,7.443A6.646,6.646,0,0,1,361.717,236.888Zm4.429-1.984c2.017-1.367,2.962-5.449,2.528-10.92-.414-5.215-2.116-7.718-5.248-7.718-3.053,0-4.74,3.594-4.735,10.087,0,3.586.157,4.62.933,6.285,1.464,3.138,3.957,4,6.521,2.266Zm-135.853-8.766v-10.73h2.048v21.461h-2.048Zm7.781-.128V215.152l1.379.169c1.356.166,1.452.323,5.631,9.249l4.252,9.081.11-9.274.11-9.274,2.032.407v21.36h-2.712l-4.221-9.014c-2.321-4.957-4.383-9.014-4.582-9.014s-.361,4.056-.361,9.014c0,8.727-.1,9.178-.9,9.178s-.742-.451-.742-11.024Zm36.04.772V216.7h-2.457c-1.873,0-2.457-.148-2.457-.622,0-.508,1.083-.645,5.939-.751,5.43-.118,5.939-.065,5.938.622,0,.632-.391.751-2.458.751h-2.457v20.173h-2.048Zm9.829-.644v-10.73H286.4v21.461h-2.457Zm10.239.644V216.7h-2.457c-1.911,0-2.457-.143-2.457-.644,0-.544.956-.644,6.143-.644,5.1,0,6.143.106,6.143.623,0,.463-.642.656-2.488.751l-2.488.128.044,9.979.044,9.979h-2.485Zm31.125,0V216.7H322.85c-2.067,0-2.457-.119-2.457-.751,0-.681.556-.751,5.938-.751s5.938.07,5.938.751c0,.632-.39.751-2.457.751h-2.457v20.173h-2.048Zm9.829-.751V215.194h4.915c4.407,0,4.915.078,4.915.751s-.449.751-3.686.751h-3.686v8.155h3.481c3.042,0,3.481.095,3.482.751s-.387.736-3.481.612l-3.482-.139v9.077h3.891c3.618,0,3.891.06,3.891.858s-.273.858-5.119.858h-5.119Zm40.545.133V215.459l4.915-.133c4.457-.12,4.915-.062,4.915.619,0,.66-.45.751-3.687.751h-3.686v8.155h3.481c2.821,0,3.481.122,3.481.644s-.66.644-3.481.644h-3.481v10.73h-2.457Z" transform="translate(-24.196 -38.011)" fill="#9ac112" stroke="#9ac112" stroke-linecap="square" stroke-width="1.5"/>
        <path id="CMR" d="M93.909,273.706a27.44,27.44,0,0,1-9.682-3.822c-2.506-1.626-6.3-5.283-7.229-6.969a4.185,4.185,0,0,0-.679-.952,24.4,24.4,0,0,1-1.632-3.314c-4-9.124-3.948-20.98.13-29.057a32.7,32.7,0,0,1,5.311-7.4c5.538-4.627,8.912-6.277,15.406-7.531,4.1-.792,15.319.061,16.509,1.255.43.432-.461,8.935-1,9.54-.2.223-1.749.059-3.61-.381-7.177-1.7-12.784-.341-17.315,4.186-6.245,6.238-7.632,15.535-3.607,24.181,1.162,2.5,1.1,2.409,3.483,5.117a15.552,15.552,0,0,0,5.083,3.673c3.18,1.535,3.284,1.553,7.96,1.379a36.146,36.146,0,0,0,6.279-.661c3.787-1.191,3.418-1.34,3.737,1.513.159,1.421.443,3.514.632,4.652.4,2.43.3,2.627-1.728,3.332-5.227,1.817-13.086,2.366-18.049,1.26Zm26.853-.973c0-.617,2.662-18.431,3.954-26.457.43-2.674.611-3.842,3.076-19.885.747-4.861,1.462-9.489,1.588-10.285l.23-1.447,6.648.122,6.648.122.839,2.651c.462,1.458,2.9,9.015,5.421,16.792,4.676,14.432,6.372,20.26,6.372,21.892,0,1.678.724.5,1.287-2.1.531-2.448,4.51-15.3,5.31-17.144.21-.486,1.6-4.662,3.088-9.28s2.875-8.794,3.081-9.28.556-1.48.775-2.209l.4-1.326h13.065l.771,4.64c.7,4.233,1.54,9.554,3.961,25.188.47,3.038,1.045,6.717,1.276,8.175s.725,4.64,1.1,7.07.866,5.612,1.1,7.07.544,3.5.694,4.529l.273,1.878h-5.981c-3.533,0-5.982-.174-5.982-.425,0-.234-.6-4.459-1.337-9.39-2.013-13.5-3.855-26.33-4.192-29.2a6.261,6.261,0,0,0-.491-2.37,44.536,44.536,0,0,0-1.286,4.55c-.959,3.816-4.364,15.131-6.1,20.266-.328.972-1.646,5.1-2.927,9.181l-2.33,7.414-11.288-.245-3.008-9.059c-6.893-20.763-9.287-28.76-9.3-31.069,0-.44-.2-.676-.444-.526a2.731,2.731,0,0,0-.44,1.78c0,.829-.481,5.341-1.068,10.027s-1.626,13.143-2.306,18.794L132,273.453h-5.617c-4.894,0-5.617-.092-5.617-.719Zm80.118-28.606V214.8l2.311-.279c1.271-.153,5.679-.277,9.795-.274,7.887,0,13.022.648,16.683,2.092a16.691,16.691,0,0,1,7.639,6.877c1.094,2.1,1.194,2.71,1.2,7.37.008,4.725-.078,5.247-1.229,7.44A17.821,17.821,0,0,1,225.9,246.8c-1.826.367-1.906.837-.454,2.688.711.907,4.875,6.67,9.254,12.807l7.96,11.158h-13.95l-4.1-6.076c-2.256-3.342-5.867-8.711-8.025-11.931a44.014,44.014,0,0,0-4.308-5.855c-.212,0-.385,5.369-.385,11.931v11.931H200.88ZM219,240.779c4.982-.819,8.008-4.19,7.964-8.871-.054-5.741-3.952-8.595-11.342-8.306l-3.522.138-.119,8.472c-.11,7.794-.057,8.489.66,8.676a17.546,17.546,0,0,0,6.359-.109Z" transform="translate(-57.515 -39.011)" fill="#9ac112"/>
        <path id="Logo" d="M48.578,226.487c-10.086-.721-19.891-4.082-24.751-8.484s-7.913-10.243-7.964-15.245l-.013-1.273,1.844,2.076c7.783,8.766,21.05,12.508,36.93,10.417,4.122-.543,10.235-1.813,20.247-4.209a132.161,132.161,0,0,1,29.208-3.658l7.879-.235-1.888-1.029a70.14,70.14,0,0,0-11.3-4.093c-2.49-.663-10.729-2.606-12.687-2.993-10.654-2.1-25.967-5.821-32.912-8-12-3.758-19.267-7.6-24.638-13.03a20.069,20.069,0,0,1-5.47-8.788c-.325-1.355.012-1.284,2.095.444,9.365,7.768,16.552,10.064,44.562,14.233,2.225.331,6.445,1.02,9.377,1.531,8.194,1.427,13.745,2.259,23.159,3.47,4.748.611,9.7,1.357,10.994,1.66a10,10,0,0,0,2.508.4c.081-.081-.647-.722-1.617-1.423-4.979-3.6-10.816-6.414-20.886-10.069a141.784,141.784,0,0,0-15.814-4.941c-10.618-2.927-15.379-4.648-22.063-7.978a50.445,50.445,0,0,1-18.595-15.045c-3.179-4.234-7.826-14.306-6.6-14.306a9.881,9.881,0,0,1,2.081,1.938c7.623,8.4,13.656,12.755,23.377,16.877,7.146,3.029,13.817,4.9,26.949,7.574,24.378,4.956,50.726,15.523,67.48,27.062,10.756,7.408,19.672,16.952,24.555,26.284,2.086,3.987,3.993,8.749,3.645,9.1-.129.129-5.906.04-12.838-.2-21.992-.758-39.231-.9-54.71-.447-14.484.423-38.14,1.545-47.438,2.251a123.075,123.075,0,0,1-14.709.124Zm138.085-2.614c3.7-14.529,4.124-26.305,1.447-40.616a115.341,115.341,0,0,0-11.669-32.689c-3.576-6.879-6.681-11.745-13.349-20.919-13.211-18.176-17.138-24.136-20.552-31.193-2.838-5.866-3.6-8.753-3.593-13.658.006-6.623,1.8-11.141,6.156-15.516a19.113,19.113,0,0,1,14.406-6.074,22.049,22.049,0,0,1,16.126,6.728c2.47,2.67,3.692,4.9,5.036,9.2.751,2.4.848,3.453.848,9.171,0,7.265-.084,7.584-3.6,13.751a46.324,46.324,0,0,0-4.138,13.289c-.136.964-.382,1.753-.547,1.753a4.819,4.819,0,0,1-1.012-1.938c-1.457-3.963-1.663-5.685-1.448-12.073.158-4.682.082-6.592-.323-8.142-.291-1.114-.869-4.683-1.284-7.931-1.015-7.947-1.607-10.651-2.927-13.369C164.381,69.823,161.369,68,156.906,68c-4.106,0-6.581,1.284-8.85,4.591-2.663,3.881-3.476,9.629-2.174,15.375,1.922,8.484,10.528,19.923,28.846,38.344a99.2,99.2,0,0,1,11.041,12.616c8.331,11.2,14,23.306,16.151,34.487a62.917,62.917,0,0,1-.191,23.63,61.481,61.481,0,0,1-8.155,18.8c-2.157,3.285-6.6,9.044-6.973,9.044-.107,0-.077-.457.065-1.015Zm-53.317-56.194c-7.067-3.584-11.07-5.167-24.822-9.82-15.629-5.287-16.863-5.728-23.225-8.3-12.015-4.85-17.825-8.362-24.8-14.993a59.5,59.5,0,0,1-14.67-23.532c-1.37-4.2-1.96-6.892-1.381-6.306.2.2,1.85,2.113,3.665,4.245,13.645,16.028,27.517,25.411,55.34,37.431,15.314,6.616,16.552,7.181,19.587,8.938,6.523,3.777,13.48,9.9,15.285,13.453a5.6,5.6,0,0,1,.658,1.6c-.065.041-2.6-1.184-5.634-2.722Zm10.113-9.578a72.091,72.091,0,0,0-17.046-12.793c-14.169-7.816-25.352-14.536-30.45-18.3a64.823,64.823,0,0,1-10.791-11.216c-4.118-5.781-8.488-16.182-10.289-24.493-.513-2.365-1.651-10.433-1.659-11.762-.007-1.048.645-.319,1.781,2a162.069,162.069,0,0,0,9.35,15.448c7.246,10.438,13.68,17.089,24.3,25.119,10.133,7.664,20.134,15.367,23.408,18.03,7.219,5.873,12.9,13.262,15.074,19.595.406,1.186.739,2.213.739,2.283,0,.462-1.008-.431-4.413-3.906Zm12.765-4.919c-4.929-7.541-14.96-18.942-27.241-30.964-11.212-10.975-16.3-17.111-19.535-23.577a37.313,37.313,0,0,1-4.15-19.615c.16-4.6,1.087-9.916,1.731-9.916a11.4,11.4,0,0,1,1.122,3.045c3.375,11.852,10.265,22.9,25.149,40.326,10.174,11.912,18.044,22.712,21.344,29.286a39.175,39.175,0,0,1,3.787,11.912,7.7,7.7,0,0,1,0,2.549,21.092,21.092,0,0,1-2.2-3.045Z" transform="translate(-15.85 -63.208)" fill="#619ed2" stroke="#619ed2" stroke-width="1"/>
        </g>
        </svg>
      </div>
      <Widget
        handleNewUserMessage={handleNewUserMessage}
        profileAvatar={logo}
          title="ChatBot"
          subtitle=""
      />
      <a style={{display: 'none'}} href='empty' ref={downloadLinkRef}>ref</a>
    </div>
  );
}

export default ChatbotWindow;